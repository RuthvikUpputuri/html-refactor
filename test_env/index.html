
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML Refactor Test Page</title>
    <link rel="stylesheet" href="index.css">
    <!-- This style block should be extracted -->
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f0f0; /* Slightly different for easy visual check */
        }
        .container {
            background-color: #ffffff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            max-width: 800px;
            margin: auto;
        }
        .original-style-block-class {
            font-style: italic;
            color: #555;
        }
    </style>
    <!-- This script block should be extracted -->
    <script>
        // Initial inline script block for testing
        function initializePage(message) {
            console.log("Page Initialized from inline script:", message);
            return `Initialized with: ${message}`;
        }
    </script>
</head>
<body>
    <div class="container">
        <h1 style="color: darkcyan; border-bottom: 3px solid darkcyan; padding-bottom: 10px; text-align: center;">HTML Refactor Test Suite</h1>
        
        <p style="font-size: 1.15em; line-height: 1.65; color: #333;">
            This page is designed to test the 
            <code style="background-color: #f0f0f0; padding: 3px 5px; border: 1px solid #ddd; border-radius: 4px;">html-refactor</code> 
            script thoroughly.
        </p>

        <div id="inline-styles-section" style="margin-top: 25px; padding: 15px; border: 1px solid #007bff; background-color: #e7f3ff; border-radius: 5px;">
            <span style="color: #d9534f; display: block; margin-bottom: 8px; font-weight: bold;">Important: This span has inline styles.</span>
            An unstyled text node follows.
            <button style="background-color: #5cb85c; color: white; padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer;">Styled Button 1</button>
            <a href="#" style="margin-left: 10px; color: #0275d8; text-decoration: none;">Styled Link</a>
        </div>

        <p class="existing-class original-style-block-class" style="margin-top:15px; background-color: #f9f9f9; border:1px solid #eee; padding:5px;">
            This paragraph has an existing class and an inline style. The inline style should be extracted, and the existing class should remain.
        </p>
        
        <div id="no-style-attribute">This div has no 'style' attribute.</div>

        <section style="border-top: 2px dashed #666; margin-top: 30px; padding-top: 20px;">
            <h2 style="text-align:left; color:#5a5a5a; font-size: 1.5em;">Nested Elements Test</h2>
            <article style="border-left: 4px solid #ffc107; padding-left:15px; background: #fff9e6;">
                <p style="font-variant: small-caps;">Article content with its own style.</p>
                <div style="padding: 5px; margin-left: 10px; border: 1px solid #ccc;">
                    <p style="color: navy;">Nested styled paragraph.</p>
                </div>
            </article>
        </section>

        <div class="important-note" style="background-color: #ffeee6;">This div has an existing class from index.css and also an inline style. The inline style should be extracted.</div>
    </div>

    <!-- An existing external script, should remain unchanged -->
    <script src="existing-external-script.js"></script> 

    <!-- Second inline script for extraction -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const initMsg = initializePage('DOM Ready!');
            const h1Element = document.querySelector('h1');
            if(h1Element) {
                const statusP = document.createElement('p');
                statusP.textContent = "Second inline script successfully executed. " + initMsg;
                // This inline style in a dynamically added element will NOT be extracted by this tool
                // as it's added programmatically after initial HTML parsing by the tool.
                statusP.style.fontStyle = "italic"; 
                statusP.style.color = "green";
                statusP.style.marginTop = "10px";
                h1Element.insertAdjacentElement('afterend', statusP);
            }
            console.log('Second inline script has completed.');
        });
    </script>
</body>
</html>
